import "tfplan-functions" as plan

# get all the resources for the aws_rds_db
allRdsDb = plan.find_resources("aws_db_instance")

minimum_retention_period = 7

violating_resources = plan.filter_attribute_less_than_value(allRdsDb, "backup_retention_period", minimum_retention_period, true)


main = rule {
    length(violating_resources["messages"]) is 0
}
