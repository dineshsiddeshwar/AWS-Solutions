# AWS-at-Shell-Platform-Engineering
This repository is for creating daily EC2 instance report along with config aggregator data and cost in AWS@Shell Master account.

## Fetching the Cost Details

Cost Details of EC2 instances are being fetched from Cost Explorer.
The automation fetches the data for two days earlier than the day of execution of the code.

This is done in order to maintain the accuracy of the cost data fetched.

## Fetching Config Aggregator Data

Config Aggregator is used to get all relevant instance details.


## Storing in s3 bucket

Both json files are stored in s3 bucket where prefixes are created according to the date of the file.

The code checks if the json generated by config aggregator exists in the bucket for the date two days ago, if yes, then it merges the cost data with that file and creates a merged csv file.

This csv file contains these fields:

accountId,resourceId,DailyCost,availabilityZone,awsRegion,configuration_imageId,configuration_instanceType,configuration_launchTime,configuration_platform,configuration_privateDnsName,configuration_privateIpAddress,configuration_publicDnsName,configuration_state_name,configuration_subnetId,configuration_vpcId,resourceCreationTime,tags

## Bucket and Lambda Details

Lambda Name - daily_instance_details
S3 Bucket Name - platform-daily-instance-report-{PayerAccountID}

## Lambda Trigger

Lambda is triggered every day at 10 AM UTC.