{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "Stmt1563375835514",
            "Action": [
                "ec2:CreateTags",
                "ec2:DeleteTags",
                "ec2:StopInstances",
                "ec2:CreateSecurityGroup",
                "ec2:CreateSecurityGroups",
                "ec2:CreateSnapshot",
                "ec2:CreateSnapshots",
                "ec2:CopySnapshot",
                "ec2:ImportSnapshot",
                "ec2:ModifySnapshotAttribute",
                "ec2:ResetSnapshotAttribute",
                "ec2:CreateVolume",
                "ec2:DeleteSecurityGroup",
                "ec2:ImportSnapshot",
                "ec2:ImportVolume",
                "ec2:ModifySnapshotAttribute",
                "ec2:CreateNetworkAcl",
                "ec2:CreateNetworkAclEntry",
                "ec2:DeleteNetworkAcl",
                "ec2:DeleteNetworkAclEntry",
                "ec2:ReplaceNetworkAclAssociation",
                "ec2:ReplaceNetworkAclEntry",
                "ec2:CreateImage",
                "ec2:ApplySecurityGroupsToClientVpnTargetNetwork",
                "ec2:AuthorizeSecurityGroupEgress",
                "ec2:AuthorizeSecurityGroupIngress",
                "ec2:DeleteSecurityGroup",
                "ec2:RevokeSecurityGroupEgress",
                "ec2:RevokeSecurityGroupIngress",
                "ec2:UpdateSecurityGroupRuleDescriptionsEgress",
                "ec2:UpdateSecurityGroupRuleDescriptionsIngress",
                "ec2:Describe*",
                "ec2:Get*",
                "ec2:SearchTransitGatewayRoutes",
                "ec2messages:Get*",
                "ssm:Describe*",
                "ssm:Get*",
                "ssm:List*",
                "ssm:SendCommand"
            ],
            "Effect": "Allow",
            "Resource": "*"
        },
        {
            "Sid": "ec2tagdeletionrestriction",
            "Action": [
                "ec2:CreateTags",
                "ec2:DeleteTags"
            ],
            "Effect": "Deny",
            "Resource": "*",
            "Condition": {
                "ForAllValues:StringEqualsIgnoreCase": {
                    "aws:TagKeys": [
                        "platform_ssminstall",
                        "platform_flexera_linux",
                        "platform_rapid7_windows",
                        "platform_rapid7_linux",
                        "platform_osversion",
                        "platform_falcon_windows",
                        "platform_falcon_linux",
                        "platform_flexera_windows",
                        "platform_cloudhealth_windows",
                        "platform_cloudhealth_linux",
                        "platform_donotdelete",
                        "platform_cloudwatch",
                        "platform_stc",
                        "platform_lob",
                        "platform_apexid",
                        "platform_requestor",
                        "platform_inspector",
                        "platform_install_patch",
                        "platform_custodian",
                        "platform_image_whitelist",
                        "platform_domainjoin_linux",
                        "platform_domainjoin_windows",
                        "platform_custodian",
                        "platform_default_patch_schedule",
                        "platform_cust_patch_schedule_01",
                        "platform_cust_patch_schedule_02"
                    ]
                }
            }
        },
        {
            "Sid": "VisualEditor0",
            "Effect": "Deny",
            "Action": [
                "ecr:*",
                "ecs:*",
                "ebs:*",
                "lambda:*",
                "s3:*",
                "elasticfilesystem:*",
                "rds:*",
                "dynamodb:*",
                "elasticache:*",
                "dms:*",
                "cloudfront:*",
                "route53:*",
                "waf:*",
                "waf-regional:*",
                "wafv2:*",
                "execute-api:*",
                "cloudwatch:*",
                "cloudtrail:*",
                "config:*",
                "ssm:*",
                "trustedadvisor:*",
                "appstream:*",
                "sagemaker:*",
                "textract:*",
                "athena:*",
                "elasticmapreduce:*",
                "kinesis:*",
                "es:*",
                "quicksight:*",
                "datapipeline:*",
                "glue:*",
                "ram:*",
                "guardduty:*",
                "secretsmanager:*",
                "kms:*",
                "sumerian:*",
                "states:*",
                "sns:*",
                "sqs:*",
                "budgets:*",
                "ce:*",
                "ses:*",
                "workdocs:*",
                "workspaces:*",
                "redshift:*",
                "appmesh:*",
                "elasticbeanstalk:*",
                "securityhub:*"
            ],
            "Resource": "*"
        }
    ]
}