{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "VisualEditor0",
            "Effect": "Deny",
            "Action": [
                "lambda:Delete*",
                "lambda:Add*",
                "lambda:Remove*",
                "lambda:EnableReplication",
                "lambda:DisableReplication",
                "s3:Delete*",
                "s3:BypassGovernanceRetention",
                "s3:ObjectOwnerOverrideToBucketOwner",
                "s3:PutBucketPublicAccessBlock",
                "elasticfilesystem:Delete*",
                "ec2:Cancel*",
                "ec2:Delete*",
                "ec2:DeregisterImage",
                "ec2:Disable*",
                "ec2:DisassociateAddress",
                "ec2:DisassociateIamInstanceProfile",
                "ec2:DisassociateRouteTable",
                "ec2:DisassociateSubnetCidrBlock",
                "ec2:AssociateSubnetCidrBlock",
                "ec2:DisassociateVpcCidrBlock",
                "ec2:AssociateVpcCidrBlock",
                "ec2:EnableVgwRoutePropagation",
                "ec2:*ClassicLink*",
                "ec2:PurchaseHostReservation",
                "ec2:PurchaseReservedInstancesOffering",
                "ec2:PurchaseScheduledInstances",
                "ec2:RejectVpcEndpointConnections",
                "ec2:RejectVpcPeeringConnection",
                "ec2:ReplaceRoute",
                "ec2:ReplaceRouteTableAssociation",
                "ec2:RequestSpotFleet",
                "ec2:RequestSpotInstances",
                "ec2:Revoke*",
                "ec2:Reset*",
                "ec2:UnmonitorInstances",
                "ec2:CreateVpc",
                "ec2:CreateSubnet",
                "ec2:CreateRoute*",
                "ec2:DeleteInternetGateway",
                "ec2:AttachInternetGateway",
                "ec2:CreateEgressOnlyInternetGateway",
                "ec2:CreateInternetGateway",
                "ec2:DeleteEgressOnlyInternetGateway",
                "ec2:DetachInternetGateway",
                "ec2:AssociateRouteTable",
                "ec2:ModifyVpcAttribute",
                "ec2:*DeleteRoute*",
                "ec2:ReplaceRoute",
                "ec2:*TransitGateway*",
                "ec2:*VpcEndpoint*",
                "ec2:*VpcPeeringConnection",
                "ec2:*LocalGatewayRouteTableVpcAssociation",
                "ec2:DeleteVpnGateway",
                "ec2:AssociateClientVpnTargetNetwork",
                "ec2:*NetworkAcl*",
                "ec2:DetachVpnGateway",
                "ec2:CreateDefaultVpc",
                "ec2:*DhcpOptions",
                "ec2:*NatGateway*",
                "ec2:*VpnConnection*",
                "ec2:MoveAddressToVpc",
                "ec2:CreateDefaultSubnet",
                "ec2:ModifyVpnTunnelCertificate",
                "ec2:CreateClientVpnRoute",
                "ec2:AttachVpnGateway",
                "ec2:CreateLocalGatewayRoute",
                "ec2:RevokeClientVpnIngress",
                "ec2:ModifyVpnTunnelOptions",
                "ec2:AuthorizeClientVpnIngress",
                "ec2:ImportClientVpnClientCertificateRevocationList",
                "ec2:*CustomerGateway*",
                "ec2:DeleteClientVpnRoute",
                "ec2:ModifyVpcTenancy",
                "ec2:ApplySecurityGroupsToClientVpnTargetNetwork",
                "ec2:DeleteSubnet",
                "ec2:DeregisterInstanceEventNotificationAttributes",
                "ec2:DisableVgwRoutePropagation",
                "ec2:CreateVpnGateway",
                "ec2:DeleteLocalGatewayRoute",
                "ec2:DeleteVpc",
                "ec2:Terminate*",
                "ec2:DisassociateClientVpnTargetNetwork",
                "ec2:DisableEbsEncryptionByDefault",
                "ec2:AllocateAddress",
                "ecr:SetRepositoryPolicy",
                "ecr:BatchDeleteImage",
                "ecr:Delete*",
                "ecs:Deregister*",
                "ecs:Delete*",
                "eks:Delete*",
                "rds:Delete*",
                "rds:PurchaseReservedDBInstancesOffering",
                "rds:RemoveSourceIdentifierFromSubscription",
                "rds:RemoveTagsFromResource",
                "rds:AuthorizeDBSecurityGroupIngress",
                "dynamodb:Delete*",
                "dynamodb:PurchaseReservedCapacityOfferings",
                "dax:Delete*",
                "elasticache:Delete*",
                "elasticache:CopySnapshot",
                "dms:Delete*",
                "cloudfront:Delete*",
                "route53:Delete*",
                "route53:DisassociateVPCFromHostedZone",
                "waf:Delete*",
                "apigateway:DELETE",
                "cloudwatch:Delete*",
                "cloudwatch:Disable*",
                "events:Delete*",
                "events:DeactivateEventSource",
                "events:DisableRule",
                "cloudtrail:RemoveTags",
                "config:Delete*",
                "servicecatalog:DisableAWSOrganizationsAccess",
                "servicecatalog:EnableAWSOrganizationsAccess",
                "servicecatalog:Delete*",
                "servicecatalog:CreatePortfolioShare",
                "trustedadvisor:SetAccountAccess",
                "trustedadvisor:ExcludeCheckItems",
                "appstream:Delete*",
                "appstream:DisableUser",
                "sagemaker:Delete*",
                "athena:Delete*",
                "elasticmapreduce:DeleteEditor",
                "elasticmapreduce:DeleteSecurityConfiguration",
                "es:Delete*",
                "es:ESHttpDelete",
                "kinesis:DeleteStream",
                "kinesis:DisableEnhancedMonitoring",
                "quicksight:Delete*",
                "datapipeline:Delete*",
                "glue:Delete*",
                "ram:DeleteResourceShare",
                "ram:DisassociateResourceShare",
                "secretsmanager:Delete*",
                "secretsmanager:CancelRotateSecret",
                "guardduty:Delete*",
                "guardduty:UpdateThreatIntelSet",
                "guardduty:UpdateDetector",
                "guardduty:DisassociateMembers",
                "guardduty:UpdateFilter",
                "guardduty:StopMonitoringMembers",
                "guardduty:DisassociateFromMasterAccount",
                "guardduty:DeclineInvitations",
                "guardduty:UpdatePublishingDestination",
                "guardduty:UntagResource",
                "kms:Delete*",
                "states:Delete*",
                "sns:Delete*",
                "sns:AddPermission",
                "sns:RemovePermission",
                "sqs:Delete*",
                "sqs:RemovePermission",
                "sqs:AddPermission",
                "ses:Delete*",
                "workspaces:Delete*",
                "workdocs:DeregisterDirectory",
                "workdocs:DeactivateUser",
                "workdocs:DeleteComment",
                "workdocs:Remove*",
                "redshift:RotateEncryptionKey",
                "redshift:Delete*",
                "redshift:PurchaseReservedNodeOffering",
                "redshift:BatchDeleteClusterSnapshots",
                "redshift:ModifyClusterIamRoles",
                "redshift:JoinGroup",
                "redshift:AuthorizeClusterSecurityGroupIngress",
                "redshift:AuthorizeSnapshotAccess",
                "redshift:CreateSnapshotCopyGrant",
                "redshift:RevokeSnapshotAccess",
                "redshift:CreateClusterUser",
                "redshift:RevokeClusterSecurityGroupIngress",
                "appmesh:Delete*",
                "elasticbeanstalk:RebuildEnvironment",
                "elasticbeanstalk:AbortEnvironmentUpdate",
                "elasticbeanstalk:TerminateEnvironment",
                "elasticbeanstalk:DeleteApplication",
                "backup:Update*",
                "backup:Delete*",
                "dlm:UpdateLifecyclePolicy",
                "dlm:DeleteLifecyclePolicy",
                "ssm:Cancel*",
                "ssm:Delete*",
                "ssm:TerminateSession",
                "ssm:Deregister*",
                "athena:DeleteDataCatalog",
                "kinesisanalytics:Delete*",
                "kinesisvideo:Delete*",
                "budgets:ModifyBudget",
                "ce:DeleteCostCategoryDefinition",
                "securityhub:InviteMembers",
                "securityhub:*Invitations",
                "securityhub:*ActionTarget",
                "securityhub:*SecurityHub*",
                "securityhub:*FindingsForProduct",
                "securityhub:DisassociateFromMasterAccount",
                "securityhub:Batch*",
                "securityhub:UntagResource",
                "securityhub:DeleteMembers",
                "securityhub:UpdateFindings",
                "securityhub:CreateMembers",
                "securityhub:TagResource",
                "securityhub:DisassociateMembers",
                "securityhub:UpdateStandardsControl",
                "cloudformation:SetStackPolicy",
                "cloudformation:Delete*",
                "apigateway:DELETE",
                "codestar:Delete*",
                "codestar:*TeamMember",
                "codestar-notifications:Delete*",
                "codestar-connections:DeleteConnection",
                "codecommit:*Disassociate*",
                "codecommit:Delete*",
                "codebuild:Delete*",
                "codedeploy:DeleteApplication",
                "codepipeline:Deregister*",
                "codepipeline:Delete*",
                "cloud9:Delete*",
                "xray:Delete*",
                "iam:*MFADevice",
                "iam:DeleteAccountPasswordPolicy",
                "iam:UpdateAccountPasswordPolicy",
                "iam:AttachUserPolicy",
                "iam:DetachUserPolicy",
                "iam:DeleteUserPolicy",
                "iam:PutUserPolicy",
                "autoscaling-plans:DeleteScalingPlan",
                "application-autoscaling:DeleteScalingPolicy",
                "autoscaling:*Delete*",
                "autoscaling:TerminateInstanceInAutoScalingGroup",
                "logs:Delete*",
                "events:DeactivateEventSource",
                "events:Delete*",
                "firehose:DeleteDeliveryStream",
                "elasticloadbalancing:Delete*",
                "shield:Disassociate*",
                "shield:Delete*",
                "elasticmapreduce:PutBlockPublicAccessConfiguration",
                "ec2:DisableEbsEncryptionByDefault",
                "cognito-identity:Delete*",
                "cognito-sync:Delete*",
                "cognito-idp:Delete*",
                "batch:TerminateJob",
                "batch:CancelJob",
                "batch:DeleteJobQueue",
                "serverlessrepo:Delete*",
                "outposts:Delete*",
                "fsx:Delete*",
                "fsx:Cancel*",
                "snowball:Cancel*",
                "storagegateway:Cancel*",
                "storagegateway:Delete*",
                "qldb:Delete*",
                "qldb:Cancel*",
                "cassandra:Drop",
                "ds:UnshareDirectory",
                "ds:DeleteConditionalForwarder",
                "ds:DeleteTrust",
                "ds:UpdateConditionalForwarder",
                "ds:DeleteDirectory",
                "sso:Import*",
                "sso:Delete*",
                "sso:Update*",
                "sso:Detach*",
                "sso:Disassociate*",
                "sso:Put*",
                "sso:AssociateDirectory",
                "sso-directory:Disable*",
                "sso-directory:Update*",
                "sso-directory:Delete*",
                "sso-directory:Create*",
                "sso-directory:Remove*",
                "kafka:DeleteCluster",
                "aws-portal:ModifyAccount",
                "account:CloseAccount",
                "account:DeleteAlternateContact",
                "account:Put*",
                "billing:PutContractInformation",
                "billing:Update*",
                "aws-portal:ModifyBilling",
                "billing:RedeemCredits",
                "ce:Create*",
                "ce:Delete*",
                "ce:ProvideAnomalyFeedback",
                "ce:StartSavingsPlansPurchaseRecommendationGeneration",
                "ce:Update*",
                "cur:PutClassicReportPreferences",
                "freetier:PutFreeTierAlertPreference",
                "invoicing:PutInvoiceEmailDeliveryPreferences",
                "payments:CreatePaymentInstrument",
                "payments:DeletePaymentInstrument",
                "payments:MakePayment",
                "payments:UpdatePaymentPreferences",
                "tax:BatchPutTaxRegistration",
                "tax:DeleteTaxRegistration",
                "tax:PutTaxInheritance",
                "aws-portal:ModifyPaymentMethods",
                "account:GetAccountInformation",
                "sts:AssumeRole"
            ],
            "Resource": "*"
        },
        {
            "Effect": "Deny",
            "Action": [
                "ec2:RunInstances"
            ],
            "Condition": {
                "BoolIfExists": {
                    "ec2:AssociatePublicIpAddress": "true"
                }
            },
            "Resource": "arn:aws:ec2:*:*:network-interface/*"
        },
        {
            "Effect": "Deny",
            "Action": "iam:CreatePolicy",
            "NotResource": "arn:aws:iam::*:policy/service-role/*"
        },
        {
            "Effect": "Deny",
            "Action": "iam:CreateRole",
            "NotResource": [
                "arn:aws:iam::*:role/aws-service-role/*",
                "arn:aws:iam::*:role/*monitoring*",
                "arn:aws:iam::*:role/*directory*",
                "arn:aws:iam::*:role/EC2InstanceProfileForImageBuilder",
                "arn:aws:iam::*:role/service-role/"
            ]
        }
    ]
}