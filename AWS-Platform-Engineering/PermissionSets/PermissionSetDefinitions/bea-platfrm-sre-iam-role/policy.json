{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "generalallow",
            "Effect": "Allow",
            "Action": [
                "xray:*",
                "transcribe:*",
                "textract:*",
                "tag:*",
                "support:*",
                "sts:*",
                "states:*",
                "ssm:*",
                "sqs:*",
                "sns:*",
                "ses:*",
                "secretsmanager:*",
                "sdb:*",
                "sagemaker:*",
                "s3:*",
                "resource-groups:*",
                "rekognition:*",
                "rds:*",
                "polly:*",
                "pi:*",
                "neptune-db:*",
                "mq:*",
                "mobileanalytics:*",
                "machinelearning:*",
                "logs:*",
                "lex:*",
                "lambda:*",
                "kms:*",
                "kafka:*",
                "iot:*",
                "iam:Simulate*",
                "iam:PassRole",
                "iam:List*",
                "iam:Get*",
                "iam:Generate*",
                "iam:CreateServiceLinkedRole",
                "health:*",
                "glue:*",
                "glacier:*",
                "execute-api:*",
                "events:*",
                "es:*",
                "elastictranscoder:*",
                "elasticmapreduce:*",
                "elasticloadbalancing:*",
                "elasticache:*",
                "elastic-inference:*",
                "eks:List*",
                "eks:Describe*",
                "ecs:*",
                "ecr:List*",
                "ecr:Get*",
                "ecr:Describe*",
                "ecr:BatchGet*",
                "ecr:BatchCheck*",
                "ec2messages:*",
                "ec2:*",
                "dynamodb:*",
                "dms:*",
                "dax:*",
                "datapipeline:*",
                "compute-optimizer:*",
                "cloudwatch:*",
                "cloudsearch:*",
                "cloudfront:*",
                "cloudformation:*",
                "cassandra:*",
                "batch:*",
                "backup:*",
                "aws-marketplace:View*",
                "aws-marketplace:Search*",
                "aws-marketplace:List*",
                "aws-marketplace:Get*",
                "aws-marketplace:Describe*",
                "autoscaling:*",
                "athena:*",
                "application-autoscaling:*",
                "apigateway:*",
                "amplify:*",
                "acm:*",
                "a4b:*",
                "access-analyzer:List*"
            ],
            "Resource": "*"
        },
        {
            "Sid": "r53allow",
            "Effect": "Allow",
            "Action": [
                "route53:UpdateTrafficPolicy*",
                "route53:UpdateHealthCheck",
                "route53:Test*",
                "route53:List*",
                "route53:Get*",
                "route53:DisassociateVPCFromHostedZone",
                "route53:DeleteVPCAssociationAuthorization",
                "route53:DeleteTrafficPolicy*",
                "route53:DeleteReusableDelegationSet",
                "route53:DeleteQueryLoggingConfig",
                "route53:DeleteHealthCheck",
                "route53:CreateVPCAssociationAuthorization",
                "route53:CreateTrafficPolicy*",
                "route53:CreateReusableDelegationSet",
                "route53:CreateQueryLoggingConfig",
                "route53:CreateHealthCheck",
                "route53:Change*",
                "route53:AssociateVPCWithHostedZone",
                "route53resolver:List*",
                "route53resolver:Get*",
                "route53domains:List*",
                "route53domains:Get*",
                "route53domains:Check*",
                "route53-recovery-control-config:List*",
                "route53-recovery-control-config:Describe*",
                "route53-recovery-readiness:List*",
                "route53-recovery-readiness:Get*"
            ],
            "Resource": "*"
        },
        {
            "Sid": "ecrallow",
            "Effect": "Allow",
            "Action": "ecr:*",
            "Resource": "arn:aws:ecr:us-east-1:679923227529:repository/*"
        },
        {
            "Sid": "IamGeneralAllow",
            "Effect": "Allow",
            "Action": [
                "iam:SetDefaultPolicyVersion",
                "iam:RemoveRoleFromInstanceProfile",
                "iam:DeletePolicy*",
                "iam:DeleteInstanceProfile",
                "iam:CreatePolicy*",
                "iam:CreateInstanceProfile",
                "iam:AddRoleToInstanceProfile"
            ],
            "Resource": "*"
        },
        {
            "Sid": "IamRoleDeleteUpdateAllow",
            "Effect": "Allow",
            "Action": [
                "iam:UpdateRoleDescription",
                "iam:UpdateRole",
                "iam:UpdateAssumeRolePolicy",
                "iam:PutRolePolicy",
                "iam:DetachRolePolicy",
                "iam:DeleteServiceLinkedRole",
                "iam:DeleteRolePolicy",
                "iam:DeleteRole",
                "iam:AttachRolePolicy"
            ],
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "iam:ResourceTag/service-team": [
                        "${aws:PrincipalTag/service-team}"
                    ]
                }
            }
        },
        {
            "Sid": "IamRoleTeamTagOnCreate",
            "Effect": "Allow",
            "Action": "iam:TagRole",
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "aws:RequestTag/service-team": [
                        "${aws:PrincipalTag/service-team}"
                    ]
                }
            }
        },
        {
            "Sid": "IamRoleTaggingAllows",
            "Effect": "Allow",
            "Action": [
                "iam:UntagRole",
                "iam:TagRole"
            ],
            "Resource": "*",
            "Condition": {
                "ForAllValues:StringNotLike": {
                    "aws:TagKeys": [
                        "service-team"
                    ]
                },
                "StringEquals": {
                    "iam:ResourceTag/service-team": [
                        "${aws:PrincipalTag/service-team}"
                    ]
                }
            }
        },
        {
            "Sid": "IamRoleCreateAllows",
            "Effect": "Deny",
            "Action": [
                "iam:PutRolePermissionsBoundary",
                "iam:CreateServiceLinkedRole",
                "iam:CreateRole"
            ],
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "aws:RequestTag/service-team": [
                        "${aws:PrincipalTag/service-team}"
                    ],
                    "iam:PermissionsBoundary": [
                        "arn:aws:iam::679923227529:policy/bea-platform-boundary-iam-policy"
                    ]
                }
            }
        },
        {
            "Sid": "IamDetachPermissionBoundary",
            "Effect": "Deny",
            "Action": [
                "iam:DeleteRolePermissionsBoundary"
            ],
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "iam:PermissionsBoundary": [
                        "arn:aws:iam:::policy/platform_ContributorExternalPermissionBoundary"
                    ]
                }
            }
        },
        {
            "Sid": "generaldeny",
            "Effect": "Deny",
            "Action": [
                "shield:Update*",
                "shield:Delete*",
                "securityhub:*",
                "outposts:*",
                "organizations:*",
                "networkmanager:*",
                "guardduty:*",
                "fms:*",
                "directconnect:*",
                "cloudtrail:Update*",
                "cloudtrail:Stop*",
                "cloudtrail:Start*",
                "cloudtrail:Remove*",
                "cloudtrail:Put*",
                "cloudtrail:Delete*",
                "cloudtrail:Create*",
                "cloudtrail:Add*",
                "cloudhsm:*",
                "aws-portal:*",
                "account:GetAccountInformation",
                "billing:Get*",
                "payments:List*",
                "payments:Get*",
                "tax:List*",
                "tax:Get*",
                "consolidatedbilling:Get*",
                "consolidatedbilling:List*",
                "invoicing:List*",
                "invoicing:Get*",
                "cur:Get*",
                "cur:Validate*",
                "freetier:Get*",
                "ce:*",
                "billing:ListBillingViews",
                "account:*"
            ],
            "Resource": "*"
        },
        {
            "Sid": "iamobjectdeny",
            "Effect": "Deny",
            "Action": [
                "iam:SetDefaultPolicyVersion",
                "iam:DeleteRole",
                "iam:DeletePolicy*",
                "iam:CreatePolicy*",
                "iam:AddRoleToInstanceProfile"
            ],
            "Resource": [
                "arn:aws:iam::679923227529:role/bea-read-only-iam-role",
                "arn:aws:iam::679923227529:role/bea-billing-iam-role",
                "arn:aws:iam::679923227529:role/bea-*-sre-iam-role",
                "arn:aws:iam::679923227529:role/bea-*-jenkins-iam-role",
                "arn:aws:iam::679923227529:role/bea-*-developer-iam-role",
                "arn:aws:iam::679923227529:role/bea-*-ci-iam-role",
                "arn:aws:iam::679923227529:role/bea-*-cd-iam-role",
                "arn:aws:iam::679923227529:policy/bea-standard-*",
                "arn:aws:iam::679923227529:policy/bea-platform-*",
                "arn:aws:iam::679923227529:policy/bea-mgmt-*"
            ]
        },
        {
            "Sid": "s3",
            "Effect": "Allow",
            "Action": "*",
            "Resource": [
                "arn:aws:s3:::sdu-leostream-terraform-state/*",
                "arn:aws:s3:::sdu-leostream-ssl-certificates/*",
                "arn:aws:s3:::sdu-leostream-admin/*"
            ]
        },
        {
            "Sid": "ec2deny",
            "Effect": "Deny",
            "Action": [
                "ec2:TerminateClientVpnConnections",
                "ec2:RevokeClientVpnIngress",
                "ec2:RestoreAddressToClassic",
                "ec2:ReplaceTransitGatewayRoute",
                "ec2:ReplaceRoute*",
                "ec2:ReplaceNetworkAcl*",
                "ec2:RejectVpcPeeringConnection",
                "ec2:RejectVpcEndpointConnections",
                "ec2:RejectTransitGateway*",
                "ec2:RegisterTransitGateway*",
                "ec2:MoveAddressToVpc",
                "ec2:ModifyVpn*",
                "ec2:ModifyVpcTenancy",
                "ec2:ModifyVpcPeering*",
                "ec2:ModifyVpcEndpointC*",
                "ec2:ModifyVpcEndpoint",
                "ec2:ModifyVpcAttribute",
                "ec2:ModifyTransit*",
                "ec2:ModifyTrafficMirror*",
                "ec2:ModifySubnetAttribute",
                "ec2:ModifyClientVpnEndpoint",
                "ec2:ImportClientVpn*",
                "ec2:Export*",
                "ec2:EnableVpcClassicLink*",
                "ec2:EnableVgwRoutePropagation",
                "ec2:EnableTransit*",
                "ec2:DisassociateVpcCidrBlock",
                "ec2:DisassociateTransitGateway*",
                "ec2:DisassociateSubnetCidrBlock",
                "ec2:DisassociateRouteTable",
                "ec2:DisassociateClientVpn*",
                "ec2:DisableVpcClassicLink*",
                "ec2:DisableVgwRoutePropagation",
                "ec2:DisableTransit*",
                "ec2:DetachVpnGateway",
                "ec2:DetachInternetGateway",
                "ec2:DetachClassicLinkVpc",
                "ec2:DeregisterTransit*",
                "ec2:DeprovisionByoipCidr",
                "ec2:DeleteVpn*",
                "ec2:DeleteVpcPeering*",
                "ec2:DeleteVpcEndpoints",
                "ec2:DeleteVpc",
                "ec2:DeleteTransitGateway*",
                "ec2:DeleteTrafficMirror*",
                "ec2:DeleteSubnet",
                "ec2:DeleteRoute*",
                "ec2:DeleteNetworkAcl*",
                "ec2:DeleteNatGateway",
                "ec2:DeleteLocalGatewayRoute*",
                "ec2:DeleteInternetGateway",
                "ec2:DeleteFlowLogs",
                "ec2:DeleteEgressOnly*",
                "ec2:DeleteDhcpOptions",
                "ec2:DeleteCustomerGateway",
                "ec2:DeleteClientVpn*",
                "ec2:CreateVpnGateway",
                "ec2:CreateVpnConnection*",
                "ec2:CreateVpcPeeringConnection",
                "ec2:CreateVpcEndpoint",
                "ec2:CreateVpc",
                "ec2:CreateTransitGateway*",
                "ec2:CreateTrafficMirror*",
                "ec2:CreateSubnet",
                "ec2:CreateRoute*",
                "ec2:CreateNetworkAclEntry",
                "ec2:CreateNetworkAcl",
                "ec2:CreateNatGateway",
                "ec2:CreateLocalGatewayRoute*",
                "ec2:CreateInternetGateway",
                "ec2:CreateFlowLogs",
                "ec2:CreateEgressOnly*",
                "ec2:CreateDhcpOptions",
                "ec2:CreateDefaultVpc",
                "ec2:CreateDefaultSubnet",
                "ec2:CreateCustomerGateway",
                "ec2:CreateClientVpn*",
                "ec2:AuthorizeClientVpn*",
                "ec2:AttachVpnGateway",
                "ec2:AttachInternetGateway",
                "ec2:AttachClassicLinkVpc",
                "ec2:AssociateVpcCidrBlock",
                "ec2:AssociateTransitGateway*",
                "ec2:AssociateSubnetCidrBlock",
                "ec2:AssociateRouteTable",
                "ec2:AssociateDhcpOptions",
                "ec2:AssociateClientVpn*",
                "ec2:AdvertiseByoipCidr",
                "ec2:AcceptVpc*",
                "ec2:AcceptTransitGateway*",
                "iam:*MFADevice",
                "iam:DeleteAccountPasswordPolicy",
                "iam:*GroupPolicy",
                "iam:AttachUserPolicy",
                "iam:DeleteUserPolicy",
                "iam:DetachUserPolicy",
                "iam:PutUserPolicy",
                "iam:ChangePassword",
                "iam:CreateAccountAlias",
                "iam:CreateLoginProfile",
                "iam:CreateSAMLProvider",
                "iam:DeleteGroupPolicy",
                "iam:DeleteInstanceProfile",
                "iam:DeleteLoginProfile",
                "elasticmapreduce:PutBlockPublicAccessConfiguration",
                "ec2:DisableEbsEncryptionByDefault",
                "ds:UnshareDirectory",
                "ds:DeleteConditionalForwarder",
                "ds:DeleteTrust",
                "ds:UpdateConditionalForwarder",
                "ds:DeleteDirectory",
                "sso:Import*",
                "sso:Delete*",
                "sso:Update*",
                "sso:Detach*",
                "sso:DisassociateDirectory",
                "sso:Put*",
                "sso:AssociateDirectory",
                "sso-directory:Disable*",
                "sso-directory:Update*",
                "sso-directory:Delete*",
                "sso-directory:Create*",
                "sso-directory:Remove*",
                "aws-portal:ModifyAccount",
                "account:CloseAccount",
                "account:DeleteAlternateContact",
                "account:Put*",
                "billing:PutContractInformation",
                "billing:Update*",
                "aws-portal:ModifyBilling",
                "billing:RedeemCredits",
                "ce:Create*",
                "ce:Delete*",
                "ce:ProvideAnomalyFeedback",
                "ce:StartSavingsPlansPurchaseRecommendationGeneration",
                "ce:Update*",
                "cur:PutClassicReportPreferences",
                "freetier:PutFreeTierAlertPreference",
                "invoicing:PutInvoiceEmailDeliveryPreferences",
                "payments:CreatePaymentInstrument",
                "payments:DeletePaymentInstrument",
                "payments:MakePayment",
                "payments:UpdatePaymentPreferences",
                "tax:BatchPutTaxRegistration",
                "tax:DeleteTaxRegistration",
                "tax:PutTaxInheritance",
                "aws-portal:ModifyPaymentMethods",
                "account:GetAccountInformation",
                "securityhub:*Disable*",
                "securityhub:DeleteInvitations",
                "securityhub:DeleteMembers",
                "securityhub:UpdateStandardsControl"
            ],
            "Resource": "*"
        },
        {
            "Effect": "Deny",
            "Action": [
                "iam:DeleteRole",
                "iam:UpdateRole",
                "iam:AttachRolePolicy",
                "iam:DetachRolePolicy",
                "iam:UpdateAssumeRolePolicy"
            ],
            "Resource": [
                "arn:aws:iam::*:role/business_service*"
            ]
        }
    ]
}