{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "sns:List*",
                "sns:CheckIfPhoneNumberIsOptedOut",
                "sns:Get*",
                "sns:TagResource",
                "sns:UntagResource",
                "sns:ConfirmSubscription",
                "sns:Create*",
                "sns:OptInPhoneNumber",
                "sns:Publish",
                "sns:Set*",
                "sns:Subscribe",
                "sns:Unsubscribe",
                "sns:VerifySMSSandboxPhoneNumber",
                "sns:AddPermission",
                "sns:RemovePermission",
                "logs:Describe*",
                "logs:List*",
                "logs:FilterLogEvents",
                "logs:Get*",
                "logs:StartQuery",
                "logs:StopQuery",
                "logs:TestMetricFilter",
                "logs:AssociateKmsKey",
                "logs:Create*",
                "logs:TagLogGroup",
                "logs:UntagLogGroup",
                "logs:UpdateLogDelivery",
                "logs:Put*",
                "logs:DisassociateKmsKey",
                "iam:Get*",
                "iam:List*",
                "iam:Generate*",
                "iam:Simulate*",
                "iam:Tag*",
                "iam:Untag*",
                "iam:Add*",
                "iam:ChangePassword",
                "iam:Create*",
                "iam:DeactivateMFADevice",
                "iam:EnableMFADevice",
                "iam:PassRole",
                "iam:Remove*",
                "iam:ResetServiceSpecificCredential",
                "iam:ResyncMFADevice",
                "iam:SetSecurityTokenServicePreferences",
                "iam:Up*",
                "iam:Attach*",
                "iam:Detach*",
                "iam:SetDefaultPolicyVersion",
                "cloudwatch:List*",
                "cloudwatch:Describe*",
                "cloudwatch:Get*",
                "cloudwatch:TagResource",
                "cloudwatch:UntagResource",
                "cloudwatch:Enable*",
                "cloudwatch:Put*",
                "cloudwatch:SetAlarmState",
                "cloudwatch:StartMetricStreams",
                "events:List*",
                "events:Describe*",
                "events:TestEventPattern",
                "events:PutRule",
                "events:TagResource",
                "events:UntagResource",
                "events:ActivateEventSource",
                "events:CancelReplay",
                "events:Create*",
                "events:EnableRule",
                "events:InvokeApiDestination",
                "events:Put*",
                "events:RemoveTargets",
                "events:StartReplay",
                "events:Up*",
                "events:RemovePermission",
                "guardduty:List*",
                "guardduty:Describe*",
                "guardduty:Get*",
                "guardduty:AcceptInvitation",
                "guardduty:ArchiveFindings",
                "guardduty:Create*",
                "guardduty:DeclineInvitations",
                "guardduty:Up*",
                "guardduty:Disa*",
                "guardduty:EnableOrganizationAdminAccount",
                "guardduty:InviteMembers",
                "guardduty:StartMonitoringMembers",
                "guardduty:StopMonitoringMembers",
                "guardduty:TagResource",
                "guardduty:UnarchiveFindings",
                "guardduty:UntagResource",
                "securityhub:Get*",
                "securityhub:List*",
                "securityhub:Up*",
                "securityhub:Create*",
                "securityhub:Describe*",
                "securityhub:Send*",
                "securityhub:TagResource",
                "securityhub:UntagResource",
                "securityhub:Accept*",
                "securityhub:Batch*",
                "securityhub:Create*",
                "securityhub:DeclineInvitations",
                "securityhub:Enable*",
                "securityhub:InviteMembers",
                "sqs:List*",
                "sqs:Get*",
                "sqs:ReceiveMessage",
                "sqs:TagQueue",
                "sqs:UntagQueue",
                "sqs:Change*",
                "sqs:Create*",
                "sqs:Send*",
                "sqs:SetQueueAttributes",
                "cloudfront:List*",
                "cloudfront:Describe*",
                "cloudfront:Get*",
                "cloudfront:Create*",
                "cloudfront:TagResource",
                "cloudfront:UntagResource",
                "cloudfront:PublishFunction",
                "cloudfront:TestFunction",
                "cloudfront:Up*",
                "ssm:List*",
                "ssm:Get*",
                "ssm:Describe*",
                "ssm:Put*",
                "ssm:AddTagsToResource",
                "ssm:RemoveTagsFromResource",
                "ssm:AssociateOpsItemRelatedItem",
                "ssm:Cancel*",
                "ssm:Create*",
                "ssm:Up*",
                "ssm:Deregister*",
                "ssm:Disassociate*",
                "ssm:LabelParameterVersion",
                "ssm:ModifyDocumentPermission",
                "ssm:Register*",
                "ssm:ResetServiceSetting",
                "ssm:ResumeSession",
                "ssm:SendAutomationSignal",
                "ssm:SendCommand",
                "ssm:StartAssociationsOnce",
                "ssm:StartAutomationExecution",
                "ssm:StartChangeRequestExecution",
                "ssm:StartSession",
                "ssm:StopAutomationExecution",
                "ssm:TerminateSession",
                "budgets:ViewBudget",
                "budgets:ModifyBudget",
                "redshift:DeleteTags",
                "redshift:CreateTags",
                "dynamodb:UntagResource",
                "dynamodb:TagResource",
                "acm:AddTagsToCertificate",
                "acm:RemoveTagsFromCertificate",
                "backup:List*",
                "backup:Describe*",
                "backup:ExportBackupPlanTemplate",
                "backup:Get*",
                "backup:ListTags",
                "backup:TagResource",
                "backup:UntagResource",
                "backup:Copy*",
                "backup:Create*",
                "backup:DisassociateRecoveryPoint",
                "backup:Put*",
                "backup:Up*",
                "backup:Start*",
                "backup-storage:*"
            ],
            "Resource": "*",
            "Effect": "Allow"
        },
        {
            "Condition": {
                "StringLike": {
                    "iam:AWSServiceName": "guardduty.amazonaws.com"
                }
            },
            "Action": [
                "iam:CreateServiceLinkedRole"
            ],
            "Resource": "arn:aws:iam::${childaccount}:role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty",
            "Effect": "Allow"
        }
    ]
}