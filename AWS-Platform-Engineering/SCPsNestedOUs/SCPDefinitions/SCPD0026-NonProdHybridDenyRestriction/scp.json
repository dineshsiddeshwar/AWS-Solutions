{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Action": [
        "aws-portal:Modify*",
        "ds:Delete*",
        "ds:UnshareDirectory",
        "ds:UpdateConditionalForwarder",
        "ec2:AcceptVpcPeeringConnection",
        "ec2:AllocateAddress",
        "ec2:ApplySecurityGroupsToClientVpnTargetNetwork",
        "ec2:AssociateClientVpnTargetNetwork",
        "ec2:AssociateDhcpOptions",
        "ec2:AssociateRouteTable",
        "ec2:AssociateSubnetCidrBlock",
        "ec2:AssociateVpcCidrBlock",
        "ec2:AttachClassicLinkVpc",
        "ec2:AttachInternetGateway",
        "ec2:AttachVpnGateway",
        "ec2:AuthorizeClientVpnIngress",
        "ec2:CreateClientVpn*",
        "ec2:CreateCustomerGateway",
        "ec2:CreateDefault*",
        "ec2:CreateEgressOnlyInternetGateway",
        "ec2:CreateInternetGateway",
        "ec2:CreateLocalGatewayRoute*",
        "ec2:CreateNatGateway*",
        "ec2:CreateNetworkAcl*",
        "ec2:CreateRoute*",
        "ec2:CreateSubnet",
        "ec2:CreateTransitGateway",
        "ec2:CreateTransitGatewayRouteTable",
        "ec2:CreateVpc*",
        "ec2:CreateVpn*",
        "ec2:DeleteClientVpn*",
        "ec2:DeleteCustomerGateway",
        "ec2:DeleteDhcpOptions",
        "ec2:DeleteEgressOnlyInternetGateway",
        "ec2:DeleteInternetGateway",
        "ec2:DeleteLocalGatewayRoute*",
        "ec2:DeleteNatGateway*",
        "ec2:DeleteNetworkAcl*",
        "ec2:DeleteRoute*",
        "ec2:DeleteSubnet",
        "ec2:DeleteTransitGateway*",
        "ec2:DeleteVpc*",
        "ec2:DeleteVpn*",
        "ec2:DeregisterInstanceEventNotificationAttributes",
        "ec2:DeregisterTransitGateway*",
        "ec2:DetachClassicLinkVpc",
        "ec2:DetachInternetGateway",
        "ec2:DetachVpnGateway",
        "ec2:DisableEbsEncryptionByDefault",
        "ec2:DisableTransitGateway*",
        "ec2:DisableVgwRoutePropagation",
        "ec2:DisableVpcClassicLink",
        "ec2:DisableVpcClassicLinkDnsSupport",
        "ec2:DisassociateAddress",
        "ec2:DisassociateClientVpnTargetNetwork",
        "ec2:DisassociateRouteTable",
        "ec2:DisassociateSubnetCidrBlock",
        "ec2:DisassociateTransitGateway*",
        "ec2:DisassociateVpcCidrBlock",
        "ec2:EnableTransitGateway*",
        "ec2:EnableVgwRoutePropagation",
        "ec2:EnableVpcClassicLink*",
        "ec2:ExportTransitGateway*",
        "ec2:GetVpnConnectionDevice*",
        "ec2:ImportClientVpnClientCertificateRevocationList",
        "ec2:ModifyClientVpnEndpoint",
        "ec2:ModifyTransitGateway*",
        "ec2:ModifyVpc*",
        "ec2:ModifyVpn*",
        "ec2:MoveAddressToVpc",
        "ec2:RegisterTransitGateway*",
        "ec2:RejectTransitGateway*",
        "ec2:RejectVpc*",
        "ec2:ReplaceNetworkAcl*",
        "ec2:ReplaceRoute*",
        "ec2:ReplaceTransitGateway*",
        "ec2:RevokeClientVpnIngress",
        "ec2:StartVpcEndpoint*",
        "ec2:TerminateClientVpnConnections",
        "elasticmapreduce:PutBlockPublicAccessConfiguration",
        "iam:ChangePassword",
        "iam:CreateAccountAlias",
        "iam:CreateLoginProfile",
        "iam:CreateSAMLProvider",
        "iam:CreateVirtualMFADevice",
        "iam:DeactivateMFADevice",
        "iam:DeleteAccountPasswordPolicy",
        "iam:DeleteGroupPolicy",
        "iam:DeleteLoginProfile",
        "iam:DeleteUserPolicy",
        "iam:DeleteVirtualMFADevice",
        "iam:EnableMFADevice",
        "iam:PutGroupPolicy",
        "iam:ResyncMFADevice",
        "iam:TagMFADevice",
        "iam:UntagMFADevice",
        "iam:UpdateAccountPasswordPolicy",
        "s3:PutBucketPublicAccessBlock",
        "securityhub:BatchDisableStandards",
        "securityhub:DeleteInvitations",
        "securityhub:DeleteMembers",
        "securityhub:DisableImportFindingsForProduct",
        "securityhub:DisableOrganizationAdminAccount",
        "securityhub:DisableSecurityHub",
        "securityhub:UpdateStandardsControl",
        "sso-directory:Create*",
        "sso-directory:Delete*",
        "sso-directory:Disable*",
        "sso-directory:Remove*",
        "sso-directory:Update*",
        "sso:AssociateDirectory",
        "sso:Delete*",
        "sso:Detach*",
        "sso:DisassociateDirectory",
        "sso:Import*",
        "sso:Put*",
        "sso:Update*"
      ],
      "Effect": "Deny",
      "Resource": "*",
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/platform*",
            "arn:aws:iam::*:role/aws-reserved/sso.amazonaws.com/*platform*",
            "arn:aws:iam::*:role/*AWSControlTower*",
            "arn:aws:iam::master_account_id:role/aws-service-role/stacksets.cloudformation.amazonaws.com/AWSServiceRoleForCloudFormationStackSetsOrgAdmin*",
            "arn:aws:iam::*:role/stacksets-exec*",
            "arn:aws:iam::*:role/aws-controltower*",
            "arn:aws:iam::*:root"
          ]
        }
      }
    }
  ]
}