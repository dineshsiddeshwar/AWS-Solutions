# Azure Kubernetes Service - Security baseline requirement <!-- omit in toc -->

## Baseline security configuration requirement for Azure services  <!-- omit in toc -->

**Generated By: EY Security Team** <br>
**Service Type: Containers** <br>
**Deployment Phase: Service Discovery** <br>
**Last updated: 05/12/2022**<br>

## Table of Contents <!-- omit in toc -->

- [Overview](#overview)
  - [Use Case Examples:](#use-case-examples)
- [Cloud Security Requirements](#cloud-security-requirements)
  - [1. Ensure Private AKS Cluster is implemented to secure network traffic to API Server](#1-ensure-private-aks-cluster-is-implemented-to-secure-network-traffic-to-api-server)
  - [2. Ensure Azure Kubernetes Service is deployed in the Virtual networks and Network Security Groups are used to protect the data in Key vault](#2-ensure-azure-kubernetes-service-is-deployed-in-the-virtual-networks-and-network-security-groups-are-used-to-protect-the-data-in-key-vault)
  - [3. Ensure the application accessing the Azure Kubernetes service is running on a platform that supports TLS 1.2 or above](#3-ensure-the-application-accessing-the-azure-kubernetes-service-is-running-on-a-platform-that-supports-tls-12-or-above)
  - [4. Ensure Azure CNI network configuration is selected and network policy between pods is configured to secure traffic](#4-ensure-azure-cni-network-configuration-is-selected-and-network-policy-between-pods-is-configured-to-secure-traffic)
  - [5.  Ensure least privilege access method is implemented using Role-based access control (RBAC)](#5--ensure-least-privilege-access-method-is-implemented-using-role-based-access-control-rbac)
  - [6. Ensure administrative tasks are performed only in admin-e workstations](#6-ensure-administrative-tasks-are-performed-only-in-admin-e-workstations)
  - [7. Ensure access to Azure Kubernetes pods are granted only using Azure Active Directory pod-managed identities](#7-ensure-access-to-azure-kubernetes-pods-are-granted-only-using-azure-active-directory-pod-managed-identities)
  - [8. Ensure Container Storage Interface (CSI) drivers are enabled on Azure Kubernetes Service and Secrets stored in Azure Key vault are mounted on AKS using CSI](#8-ensure-container-storage-interface-csi-drivers-are-enabled-on-azure-kubernetes-service-and-secrets-stored-in-azure-key-vault-are-mounted-on-aks-using-csi)
  - [9. Ensure Activity logging is enabled for Azure Kubernetes service](#9-ensure-activity-logging-is-enabled-for-azure-kubernetes-service)
  - [10. Ensure NSG flow log data is enabled for AKS Cluster Subnet and encrypted using customer managed key](#10-ensure-nsg-flow-log-data-is-enabled-for-aks-cluster-subnet-and-encrypted-using-customer-managed-key)
  - [11. Ensure Diagnostic logs for 'Kubeapi' and 'Kubeaudit' are enabled and are forwarded to Splunk](#11-ensure-diagnostic-logs-for-kubeapi-and-kubeaudit-are-enabled-and-are-forwarded-to-splunk)
  - [12. Ensure node pools are always updated to the latest Kubernetes version](#12-ensure-node-pools-are-always-updated-to-the-latest-kubernetes-version)
  - [13. Ensure Azure Kubernetes service uses standard organizational Resource tagging method](#13-ensure-azure-kubernetes-service-uses-standard-organizational-resource-tagging-method)
  - [14. Ensure Microsoft Defender for containers is enabled to improve, monitor, and maintain the security of service clusters, containers, and their applications.s](#14-ensure-microsoft-defender-for-containers-is-enabled-to-improve-monitor-and-maintain-the-security-of-service-clusters-containers-and-their-applicationss)
  - [15. Ensure that local Authentication method is disabled for Azure Kubernetes service cluster and Azure Active Directory is the only authentication source](#15-ensure-that-local-authentication-method-is-disabled-for-azure-kubernetes-service-cluster-and-azure-active-directory-is-the-only-authentication-source)
  - [16. Ensure only organization approved container images are used for deployment in AKS](#16-ensure-only-organization-approved-container-images-are-used-for-deployment-in-aks)
  - [17. Ensure container image in AKS adheres to organization patch and vulnerability management standards](#17-ensure-container-image-in-aks-adheres-to-organization-patch-and-vulnerability-management-standards)
  - [18. Ensure System Configurations is configured using Pod security Policy](#18-ensure-system-configurations-is-configured-using-pod-security-policy)
  - [19. Ensure all the secrets within AKS are stored in Azure Key Vault](#19-Ensure-all-the-secrets-within-AKS-are-stored-in-Azure-Key-Vault)


##  Overview 

Azure Kubernetes Service (AKS) is used to deploy a managed Kubernetes cluster in Azure by offloading the operational overhead to Azure. As a hosted Kubernetes service, Azure handles critical tasks, like health monitoring and maintenance. Kubernetes masters are managed by Azure and the agent nodes are managed and maintained. 

![archi](https://docs.microsoft.com/en-us/azure/architecture/browse/thumbs/implement-drone-delivery.png)

| Control Number | Cloud Baseline Security Requirements                                                                                                                         |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1              | Ensure Private AKS Cluster is implemented to secure network traffic to API Server                                                                            |
| 2              | Ensure Azure Kubernetes Service is deployed in the Virtual networks and Network Security Groups are used to protect the data in Key vault                    |
| 3              | Ensure the application accessing the Azure Kubernetes service is running on a platform that supports TLS 1.2 or above                                        |
| 4              | Ensure Azure CNI network configuration is selected and network policy between pods is configured to secure traffic                                           |
| 5              | Ensure least privilege access method is implemented using Role-based access control (RBAC)                                                                   |
| 6              | Ensure administrative tasks are performed only in admin-e workstations                                                                                       |
| 7              | Ensure access to Azure Kubernetes pods are granted only using Azure Active Directory pod-managed identities                                                  |
| 8              | Ensure Container Storage Interface (CSI) drivers are enabled on Azure Kubernetes Service and Secrets stored in Azure Key vault are mounted on AKS using CSI  |
| 9              | Ensure Activity logging is enabled for Azure Kubernetes service                                                                                              |
| 10             | Ensure NSG flow log data is enabled for AKS Cluster Subnet and encrypted using customer managed key                                                          |
| 11             | Ensure Diagnostic logs for 'Kubeapi' and 'Kubeaudit' are enabled and are forwarded to Splunk                                                                 |
| 12             | Ensure node pools are always updated to the latest Kubernetes version                                                                                        |
| 13             | Ensure Azure Kubernetes service uses standard organizational Resource tagging method                                                                         |
| 14             | Ensure Microsoft Defender for containers is enabled to improve, monitor, and maintain the security of service clusters, containers, and their applications.s |
| 15             | Ensure that local Authentication method is disabled for Azure Kubernetes service cluster and Azure Active Directory is the only authentication source        |
| 16             | Ensure only organization approved container images are used for deployment in AKS                                                                            |
| 17             | Ensure container image in AKS adheres to organization patch and vulnerability management standards                                                           |
| 18             | Ensure System Configurations is configured using Pod security Policy                                                                                         |
| 19             | Ensure all the secrets within AKS are stored in Azure Key Vault                                                                                              |

### Use Case Examples:
- Instant IoT data streaming with AKS
- Distributed business transaction performance tuning
- Real-time scoring of R machine learning models

## Cloud Security Requirements ##

### 1. Ensure Private AKS Cluster is implemented to secure network traffic to API Server ###

**Security Control Mapping :** <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012300 | Cloud products and services must be deployed on private subnets and public access must be disabled for these services | Network and communication Security | Not enabled |Network Security Group Runbook | [High (7.2)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:L/A:L) |

**Why?** <br>
  
A private AKS cluster must be implemented to ensure network traffic between AKS API server and node pools remains only on the private network. The control plane or API server, resides in an AKS-managed Azure subscription and uses internal (RFC1918) IP addresses, while the organization's cluster or node pool is in their own subscription. The server and the cluster or node pool must communicate with each other using the Azure Private Link service in the API server virtual network and a private endpoint that's exposed in the subnet of the customer's AKS cluster. Without private link service the commands like kubectl will run against the public endpoint, hence any misconfiguration may alow attacker to use public endpoint to run malicious command on AKS cluster.


**How?** <br>

    `This will be updated soon`
<br><br> 

### 2. Ensure network connectivity using Kubenet is secured using Calico Network Policies  ###

**Security Control Mapping :** <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012300 | Cloud products and services must be deployed on private subnets and public access must be disabled for these services | Network and communication Security | Not enabled |Network Security Group Runbook | [High (7.2)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:L/A:L) |

**Why?** <br>

     Pods can't communicate directly with each other in Kubenet and only the nodes receive an IP address in the virtual network subnet. User Defined Routing (UDR) and IP forwarding must be used for connectivity between pods across nodes. Pods can also be deploy  behind a service that receives an assigned IP address and load balances traffic for the application. Calico network policy must be used and it can be applied to multiple types of endpoints including pods, VMs, and host interfaces
    
**How?** <br>

    `This will be updated soon`
<br><br> 

### 3. Ensure the application accessing the Azure Kubernetes service is running on a platform that supports TLS 1.2 or above ###

**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012300 | Cloud products and services must be deployed on private subnets and public access must be disabled for these services | Network and communication Security| Not enabled | Virtual Network Runbook | [Medium (5.3)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:H/I:L/A:L) |

**Why?** <br>

    Data in transit between Application and Azure Key vault services can be encrypted based on the nature of the connection. Microsoft uses the Transport Layer Security (TLS) protocol to protect data when it's traveling between the key vault services and applications. TLS 1.2 must be used as the secure encryption in transit for all the key vault connections to improve the security posture of the environment and also to remain in compliance with industry standards or organization requirements

**How?** <br>

    `This will be updated soon`
<br><br> 

### 4. Ensure Azure CNI network configuration is secured using network policy between pods ###

**Security Control Mapping :** <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012300 | Cloud products and services must be deployed on private subnets and public access must be disabled for these services | Network and communication Security | Not enabled |Network Security Group Runbook | [High (7.2)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:L/A:L) |

**Why?** <br>

     In Azure Container Networking Interface (CNI) every pod gets an IP address from the subnet and can be accessed directly across network. AKS network policies must be enabled to limit network traffic by defining rules for ingress and egress traffic between Linux pods in a cluster based on choice of namespaces and label selectors. Network policy will use the Azure CNI plug-in with defined virtual network and subnets and can only be enabled at cluster creation. 

**How?** <br>

    `This will be updated soon`
<br><br>

### 5.  Ensure least privilege access method is implemented using Role-based access control (RBAC) ###

**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012300 | Cloud products and services must be deployed on private subnets and public access must be disabled for these services |Identity & Access Management | Not enabled | Virtual Network Runbook | [Medium (5.2)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:H/A:L) |

**Why?** <br>

    Role-based access control (RBAC) is method of implementing least privilege access by providing access user and service principle based on job function. Azure has several service specific roles the provides granular access. Using Azure entitlements and the usage pattern custom roles can be developed to implement the granular access to individual user and service principal. Organization segregates Network, Storage and platform job functions and each functional team will have custom role specific to their job functions. Example: Storage team will have admin roles ito provision and configure the storage services but will not have access to configure VNet.

**Following are the suggested RBAC roles for Azure Kubernetes service** <br>
| Function | Description | Role | 
| -------------- | ----------------- | --------------- | 
|  Key vault admin | Responsible for  provisioning  and rotatingKey key vaults | EncryptionKeymgmtAdmin |
|  Network admin | Responsible for configuring Virtual network and managing network configuration | Networkadmin |
|  Platform admin | Responsible for configuring Kubenet and CNI | KubernetesPlatformadmin |
|  Monitoring admin | Responsible for monitoring and auditing the key Vault operation logs | MonitoringPlatformadmin |

**How?** <br>

    `This will be updated soon`
<br><br> 

### 6. Ensure administrative tasks are performed only in admin-e workstations ###

**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
|  CS0012298	 | Access to change cloud identity access and service control policies is restricted to authorized cloud administrative personnel |  Identity & Access Management | Not enabled | None | [Low (3.0)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:N)|

**Why?** <br>

    A Privileged workstation provides a hardened workstation that has clear application control and application guard. The workstation uses credential guard, device guard, app guard, and exploit guard to protect the host from malicious behavior. All the administrative tasks must be performed only using these Privileged workstation

**How?** <br>

    `This will be updated soon`
<br><br> 

### 7. Ensure access to Azure Kubernetes pods are granted only using Azure Active Directory pod-managed identities ###

**Security Control Mapping :** 

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
|  CS0012298       | Access to change cloud identity access and service control policies is restricted to authorized cloud administrative personnel |Identity & Access Management | Not enabled | None | [Medium (5.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:L) |

**Why?** <br>

    Managed identity enables Azure resources to authenticate to cloud services (e.g. Azure Key Vault) without storing credentials in code. Once enabled, all necessary permissions can be granted via Azure role-based-access-control. 
    Azure Active Directory (Azure AD) pod-managed identities will use Kubernetes primitives to associate managed identities for Azure resources and identities in Azure AD with pods. Administrators create identities and bindings as Kubernetes primitives that allow pods to access Azure resources that rely on Azure AD as an identity provide . Hence Azure Active Directory pod-managed identities must be used to provide access to Azure Kubernetes pods which will later by replaced by workload identity

    To learn more about workload identity , refer https://cloudblogs.microsoft.com/opensource/2022/01/18/announcing-azure-active-directory-azure-ad-workload-identity-for-kubernetes/

**How?** <br>

    `This will be updated soon`
<br><br> 

### 8. Ensure Container Storage Interface (CSI) drivers are enabled on Azure Kubernetes Service and Secrets stored in Azure Key vault are mounted on AKS using CSI ###

**Security Control Mapping :** <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
|  CS0012298	 | Access to change cloud identity access and service control policies is restricted to authorized cloud administrative personnel |  Identity & Access Management | Not enabled | None | [Medium (5.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:L) |

**Why?** <br>

    The Container Storage Interface (CSI) must be used as a standard for exposing arbitrary block and file storage systems to containerized workloads on Kubernetes. CSI must be adopted and used in Azure Kubernetes Service (AKS) to write, deploy, and iterate plug-ins to expose new or improve existing storage systems in Kubernetes without modifying the kubernetes source code. Azure Key Vault provider for Secrets Store CSI driver must be allowed  to get secret contents stored in an Azure Key Vault instance and the Secrets Store CSI driver interface must be used to mount them into Kubernetes pods.

**How?** <br>

    `This will be updated soon`
<br><br> 

 ### 9. Ensure Activity logging is enabled for Azure Kubernetes service ###
  
**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012233 | Information System must create a log and record activities occurring on or originating from the information system. Logs must be made accessible to the enterprise SIEM solution  | Security Information and event management   | Enabled but not forwarded to Splunk | None | [Low (2.7)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:P/AC:H/PR:H/UI:N/S:U/C:L/I:N/A:L) |

**Why?** <br>

    The Activity log is a type of platform log in Azure that must be enabled to provide insight into subscription-level events> Logs can be viewed independently or route it to Azure Monitor Logs, where Activity logs can be used to find an error when troubleshooting or to monitor how a user modified a resource.

**How?** <br>

    `This will be updated soon`
<br><br> 

### 10. Ensure NSG flow log data is enabled for AKS Cluster Subnet and encrypted using customer managed key ###

**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012233 | Information System must create a log and record activities occurring on or originating from the information system. Logs must be made accessible to the enterprise SIEM solution  | Security Information and event management  | Not Enabled | Network Watcher Runbook | [Low (2.7)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:P/AC:H/PR:H/UI:N/S:U/C:L/I:N/A:L) |

**Why?** <br>

    Network security group (NSG) flow logs is a feature of Azure Network Watcher that logs information about IP traffic flowing through an NSG. The Flow data then is sent to Azure Storage accounts where it can be accessed as well as exported to any visualization tool, SIEM, or IDS .The storage of the NSG flow logs must be encrypted using a Customer Managed key as they contain sensitive information about traffic like source, destination ips, ports and times moving through Virtual networks

**How?** <br>

    `This will be updated soon`
<br><br> 

### 11. Ensure Diagnostic logs for 'Kubeapi' and 'Kubeaudit' are enabled and are forwarded to Splunk ###

**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012233 | Information System must create a log and record activities occurring on or originating from the information system. Logs must be made accessible to the enterprise SIEM solution  | Security Information and event management  | Not Enabled | Network Watcher Runbook | [Low (2.7)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:P/AC:H/PR:H/UI:N/S:U/C:L/I:N/A:L) |

**Why?** <br>
  
    The event log contains information about the api objects which include pods, services, replicationcontrollers, and other This logs when forwarded to Splunk provide necessary information to create notable alerts for any rule created to allow connection from internet

**How?** <br>

    `This will be updated soon`
<br><br> 

### 12. Ensure node pools are always updated to the latest Kubernetes version ###

**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012261  | Technology hardware and software must be registered and accurately recorded within the enterprise technology repository and/or asset management systems | Asset Management  | Not enabled | organizational Runbook | [Low (3.0)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:N)|

**Why?**<br>
      
       AKS Virtual Machine hosts must be upgraded on the Windows Server node pools in AKS clusters through Azure control panel or the Azure CLI to deploy new nodes with the latest approved Windows Server image. Additionally, ensure AKS cluster node's third- party applications remain patched for the duration of the cluster lifetime. This may require enabling automatic updates, monitoring the nodes, or performing periodic reboots.

**How?** <br>

    `This will be updated soon`
<br><br> 

### 13. Ensure Azure Kubernetes service uses standard organizational Resource tagging method ###

**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012261  | Technology hardware and software must be registered and accurately recorded within the enterprise technology repository and/or asset management systems | Asset Management  | Not enabled | organizational Runbook | [Low (1.6)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:P/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:L) |

**Why?**<br>
  
    Tagging the Azure Kubernetes service will help to identify the logical way to own the resource and group them and also helping to assess their security posture and take action on potential areas of weakness.

**How?** <br>

    `This will be updated soon`
<br><br> 

### 14. Ensure Microsoft Defender for containers is enabled to improve, monitor, and maintain the security of service clusters, containers, and their applications.s ###

**Security Control Mapping :** <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
|  CS0012268       |Vulnerability Assessments must be performed based on risk and findings must be addressed in accordance with Enterprise SLA's | Vulnerability Management | Not enabled | None | [Medium (5.0)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:L) |

**Why?** <br>

    Microsoft Defender for containers must be enabled for Azure-native, advanced threat protection for Azure kubernetes, providing an additional layer of security intelligence. Microsoft Defender for containers detects unusual and potentially harmful attempts like exposed Kubernetes dashboards, creation of high-privileged roles, and the creation of sensitive mounts. 

### 15. Ensure that local Authentication method is disabled for Azure Kubernetes service cluster and Azure Active Directory is the only authentication source ###

**Security Control Mapping :** <br>
| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ------------------|---------------- |---------|--------------------|--------------- |
|  CS0012298	 | Access to change cloud identity access and service control policies is restricted to authorized cloud administrative personnel |  Identity and Access Management | Not enabled | None | [Medium (5.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:L) |

**Why?** <br>

     Azure AD administrator users can create/enable users for Azure AD-based authentication. it is recommend not using the Azure AD administrator for regular kubernetes operations, as it has elevated user permissions. RBAC role should be used for regular operations. Azure AD accounts uses access tokens to authenticate user against the Azure AD.  Managed Identities are automatically managed by Azure and enables application/user to authenticate to services that support Azure AD authentication, without needing to insert credentials into code.

**How?** <br>

    `This will be updated soon`
<br><br> 

### 16. Ensure only organization approved container images are used for deployment in AKS ###

**Security Control Mapping :** <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012261  | Technology hardware and software must be registered and accurately recorded within the enterprise technology repository and/or asset management systems | Asset Management  | Not enabled | Network Watcher runbook | [Critical (9.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:H/A:L)  |

**Why?** <br>

    Organization approved Container images are the Azure Resource Manager templates which are customized and configured to meet the organization and compliance policies. New instances of the VM must be deployed only using these approved images promoting the uniformity and secured design. Patch updates and maintenance will be done to this approved VM Images by Infrastructure team

**How?** <br>

    `This will be updated soon`
<br><br>

### 17. Ensure container image in AKS adheres to organization patch and vulnerability management standards ###

**Security Control Mapping :**  <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
|   CS0012267   | Security related patches and fixes are applied to systems and applications in accordance with enterprise defined SLA's | Asset Management  | Not enabled | [Critical (9.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:H/A:L) |
**Why?** <br>

        Vulnerabilities are weakness in software that can expose a system to unwanted malicious activity. By applying regular patches and performing regular vulnerability scans based on the enterprise standard SLA will ensure less likely to be exploited

**How?** <br>

    `This will be updated soon`
<br><br>

### 18. Ensure System Configurations is configured using Pod security Policy ###

**Security Control Mapping :** <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
| CS0012261  | Technology hardware and software must be registered and accurately recorded within the enterprise technology repository and/or asset management systems | Asset Management  | Not enabled | Network Watcher runbook | [Critical (9.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:H/A:L)  |

**Why?** <br>

   PodSecurityPolicy is an admission controller that validates a pod specification meets the defined requirements. These requirements may limit the use of privileged containers, access to certain types of storage, or the user or group the container can run as. When you try to deploy a resource where the pod specifications don't meet the requirements outlined in the pod security policy, the request is denied. This ability to control what pods can be scheduled in the AKS cluster prevents some possible security vulnerabilities or privilege escalations

**How?** <br>

    `This will be updated soon`
<br><br> 

### 19. Ensure all the secrets within AKS are stored in Azure Key Vault ###

**Security Control Mapping :** <br>

| Control Number | Control Statement | Security Domain | Default | Associated Runbook | CVSS Severity  |
| -------------- | ----------------- | --------------- | ------- | ------------------ | -------------- |
|   |  | Asset Management  |  |  | [] |

**Why?** <br>
   
    `This will be updated soon`
**How?** <br>

    `This will be updated soon`
<br><br> 



