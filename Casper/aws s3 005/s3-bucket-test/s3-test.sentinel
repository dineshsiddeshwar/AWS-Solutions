# Ensure that s3 Bucket acl has public access disabled i.e s3 bucket, acl="private"

# Imports common-functions
import "tfplan-functions" as tfplan

# Get all AWS Instance
s3bucketAcl = tfplan.find_resources("aws_s3_bucket_acl")

# set the value as public to the variable
bucket_acl = "public"

# Return all the instances with public ip associated
violating_resources = tfplan.filter_attribute_is_value(s3bucketAcl,"acl",bucket_acl,false)
#print(violating_resources["messages"])

# Main rule
main = rule { 
    length(violating_resources["messages"]) is 0
}